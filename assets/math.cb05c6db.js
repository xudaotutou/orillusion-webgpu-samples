var O=1e-6,j=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,n=arguments.length;n--;)r+=arguments[n]*arguments[n];return Math.sqrt(r)});function N(){var r=new j(16);return j!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function R(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Y(r,n,i){var e=n[0],v=n[1],a=n[2],y=n[3],c=n[4],s=n[5],f=n[6],h=n[7],M=n[8],l=n[9],x=n[10],w=n[11],A=n[12],V=n[13],F=n[14],P=n[15],z=i[0],p=i[1],m=i[2],g=i[3];return r[0]=z*e+p*c+m*M+g*A,r[1]=z*v+p*s+m*l+g*V,r[2]=z*a+p*f+m*x+g*F,r[3]=z*y+p*h+m*w+g*P,z=i[4],p=i[5],m=i[6],g=i[7],r[4]=z*e+p*c+m*M+g*A,r[5]=z*v+p*s+m*l+g*V,r[6]=z*a+p*f+m*x+g*F,r[7]=z*y+p*h+m*w+g*P,z=i[8],p=i[9],m=i[10],g=i[11],r[8]=z*e+p*c+m*M+g*A,r[9]=z*v+p*s+m*l+g*V,r[10]=z*a+p*f+m*x+g*F,r[11]=z*y+p*h+m*w+g*P,z=i[12],p=i[13],m=i[14],g=i[15],r[12]=z*e+p*c+m*M+g*A,r[13]=z*v+p*s+m*l+g*V,r[14]=z*a+p*f+m*x+g*F,r[15]=z*y+p*h+m*w+g*P,r}function E(r,n,i){var e=i[0],v=i[1],a=i[2],y,c,s,f,h,M,l,x,w,A,V,F;return n===r?(r[12]=n[0]*e+n[4]*v+n[8]*a+n[12],r[13]=n[1]*e+n[5]*v+n[9]*a+n[13],r[14]=n[2]*e+n[6]*v+n[10]*a+n[14],r[15]=n[3]*e+n[7]*v+n[11]*a+n[15]):(y=n[0],c=n[1],s=n[2],f=n[3],h=n[4],M=n[5],l=n[6],x=n[7],w=n[8],A=n[9],V=n[10],F=n[11],r[0]=y,r[1]=c,r[2]=s,r[3]=f,r[4]=h,r[5]=M,r[6]=l,r[7]=x,r[8]=w,r[9]=A,r[10]=V,r[11]=F,r[12]=y*e+h*v+w*a+n[12],r[13]=c*e+M*v+A*a+n[13],r[14]=s*e+l*v+V*a+n[14],r[15]=f*e+x*v+F*a+n[15]),r}function k(r,n,i){var e=i[0],v=i[1],a=i[2];return r[0]=n[0]*e,r[1]=n[1]*e,r[2]=n[2]*e,r[3]=n[3]*e,r[4]=n[4]*v,r[5]=n[5]*v,r[6]=n[6]*v,r[7]=n[7]*v,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=n[11]*a,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r}function q(r,n,i){var e=Math.sin(i),v=Math.cos(i),a=n[4],y=n[5],c=n[6],s=n[7],f=n[8],h=n[9],M=n[10],l=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=a*v+f*e,r[5]=y*v+h*e,r[6]=c*v+M*e,r[7]=s*v+l*e,r[8]=f*v-a*e,r[9]=h*v-y*e,r[10]=M*v-c*e,r[11]=l*v-s*e,r}function L(r,n,i){var e=Math.sin(i),v=Math.cos(i),a=n[0],y=n[1],c=n[2],s=n[3],f=n[8],h=n[9],M=n[10],l=n[11];return n!==r&&(r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=a*v-f*e,r[1]=y*v-h*e,r[2]=c*v-M*e,r[3]=s*v-l*e,r[8]=a*e+f*v,r[9]=y*e+h*v,r[10]=c*e+M*v,r[11]=s*e+l*v,r}function S(r,n,i){var e=Math.sin(i),v=Math.cos(i),a=n[0],y=n[1],c=n[2],s=n[3],f=n[4],h=n[5],M=n[6],l=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=a*v+f*e,r[1]=y*v+h*e,r[2]=c*v+M*e,r[3]=s*v+l*e,r[4]=f*v-a*e,r[5]=h*v-y*e,r[6]=M*v-c*e,r[7]=l*v-s*e,r}function T(r,n,i,e,v){var a=1/Math.tan(n/2),y;return r[0]=a/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,v!=null&&v!==1/0?(y=1/(e-v),r[10]=(v+e)*y,r[14]=2*v*e*y):(r[10]=-1,r[14]=-2*e),r}var X=T;function Z(r,n,i,e,v,a,y){var c=1/(n-i),s=1/(e-v),f=1/(a-y);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(n+i)*c,r[13]=(v+e)*s,r[14]=(y+a)*f,r[15]=1,r}var H=Z;function _(r,n,i,e){var v,a,y,c,s,f,h,M,l,x,w=n[0],A=n[1],V=n[2],F=e[0],P=e[1],z=e[2],p=i[0],m=i[1],g=i[2];return Math.abs(w-p)<O&&Math.abs(A-m)<O&&Math.abs(V-g)<O?R(r):(h=w-p,M=A-m,l=V-g,x=1/Math.hypot(h,M,l),h*=x,M*=x,l*=x,v=P*l-z*M,a=z*h-F*l,y=F*M-P*h,x=Math.hypot(v,a,y),x?(x=1/x,v*=x,a*=x,y*=x):(v=0,a=0,y=0),c=M*y-l*a,s=l*v-h*y,f=h*a-M*v,x=Math.hypot(c,s,f),x?(x=1/x,c*=x,s*=x,f*=x):(c=0,s=0,f=0),r[0]=v,r[1]=c,r[2]=h,r[3]=0,r[4]=a,r[5]=s,r[6]=M,r[7]=0,r[8]=y,r[9]=f,r[10]=l,r[11]=0,r[12]=-(v*w+a*A+y*V),r[13]=-(c*w+s*A+f*V),r[14]=-(h*w+M*A+l*V),r[15]=1,r)}function d(){var r=new j(3);return j!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function I(r,n,i){var e=new j(3);return e[0]=r,e[1]=n,e[2]=i,e}(function(){var r=d();return function(n,i,e,v,a,y){var c,s;for(i||(i=3),e||(e=0),v?s=Math.min(v*i+e,n.length):s=n.length,c=e;c<s;c+=i)r[0]=n[c],r[1]=n[c+1],r[2]=n[c+2],a(r,r,y),n[c]=r[0],n[c+1]=r[1],n[c+2]=r[2];return n}})();function J(r,n,i,e){const v=B(n,i,e),a=G(r),y=N();return Y(y,a,v),y}function B(r={x:0,y:0,z:0},n={x:0,y:0,z:0},i={x:1,y:1,z:1}){const e=N();return E(e,e,I(r.x,r.y,r.z)),q(e,e,n.x),L(e,e,n.y),S(e,e,n.z),k(e,e,I(i.x,i.y,i.z)),e}const C=I(0,0,0),D=I(0,1,0);function G(r,n=60/180*Math.PI,i=.1,e=100,v={x:0,y:0,z:0}){const a=N(),y=I(v.x,v.y,v.z);E(a,a,y),_(a,y,C,D);const c=N();return X(c,n,r,i,e),Y(c,c,a),c}export{G as a,J as b,N as c,I as f,B as g,_ as l,Y as m,H as o};
